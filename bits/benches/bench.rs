use bits::{f32_embedding_to_bsp, EvpBits};
use bitvec_simd::BitVecSimd;
use std::hint::black_box;
use utils::arg_sort;

const EMBEDDING: &[f32] = &[
    -0.014339903,
    -0.047637787,
    -0.027555097,
    0.06721365,
    -0.066670686,
    -0.012045057,
    0.047831252,
    0.11956464,
    0.009439636,
    -0.021930082,
    -0.06163209,
    0.018646596,
    -0.02293244,
    -0.0010262321,
    -0.025684329,
    -0.05691602,
    0.15020971,
    -0.040204022,
    0.0055531366,
    -0.010786444,
    0.059372634,
    -0.0065493328,
    0.025750084,
    0.051228136,
    -0.0062211053,
    -0.11873502,
    0.026878703,
    -0.049817078,
    -0.006954293,
    0.0007034913,
    0.011053576,
    -0.041715756,
    -0.0026646217,
    -0.02293646,
    -0.054238003,
    0.089124426,
    -0.013021417,
    -0.03533584,
    -0.14963861,
    -0.0472405,
    -0.0100810565,
    -0.02533059,
    -0.015163636,
    0.051865436,
    0.028131092,
    -0.06607222,
    -0.073820285,
    0.097792715,
    0.013039903,
    0.07193687,
    -0.0046784882,
    -0.055744093,
    -0.0009151904,
    0.042728335,
    -0.029827798,
    -0.018971296,
    -0.1620726,
    -0.019674629,
    -0.09533858,
    -0.0043800063,
    -0.14668472,
    0.046083815,
    0.01727265,
    -0.0045447918,
    -0.012501251,
    -0.050915312,
    0.018583456,
    -0.13001668,
    0.008261126,
    0.025210159,
    0.0052336627,
    -0.07530536,
    -0.0052267215,
    -0.016529085,
    -0.038778115,
    -0.026919318,
    -0.061606854,
    0.005580974,
    -0.062328245,
    0.01664998,
    0.107361205,
    0.109655656,
    0.08473557,
    0.09834304,
    0.007352697,
    0.030561067,
    0.032896392,
    0.08197198,
    -0.08609997,
    -0.06290066,
    0.033986382,
    0.05861303,
    -0.05124204,
    0.06474116,
    -0.011125626,
    -0.059091274,
    -0.09163366,
    -0.024001302,
    0.006693322,
    0.015485523,
    -0.016556768,
    0.056506623,
    -0.014936371,
    0.027967539,
    -0.05577882,
    0.017812368,
    0.03117342,
    0.02767558,
    0.03855915,
    -0.010261767,
    0.04122843,
    0.09076582,
    0.010587806,
    0.074946515,
    -0.052217375,
    0.045625575,
    0.048722062,
    0.033157267,
    -0.007882794,
    0.039161507,
    -0.09044154,
    -0.05520291,
    0.046681765,
    -0.10686308,
    -0.042439193,
    0.014694129,
    0.0794213,
    4.2922453e-33,
    0.015264952,
    -0.08680359,
    -0.005861381,
    -0.025231887,
    -0.009966276,
    0.053692468,
    -0.015735911,
    0.03290123,
    0.061264914,
    0.01653722,
    -0.04386725,
    -0.097951084,
    0.013367128,
    0.11886037,
    -0.011701032,
    0.031215796,
    0.049347635,
    0.030009603,
    0.0370843,
    -0.067806974,
    -0.041451167,
    0.029273894,
    0.023537727,
    -0.025573734,
    0.019305008,
    0.095863655,
    -0.090271115,
    0.035475664,
    0.0070602843,
    -0.029097116,
    0.012535195,
    -0.020838352,
    -0.061137047,
    -0.010384245,
    -0.018771665,
    -0.036446445,
    0.016089834,
    -0.01277495,
    0.010186537,
    0.02163196,
    -0.009011217,
    0.031001823,
    0.030150589,
    -0.079166524,
    0.08275965,
    0.04827961,
    -0.005049146,
    -0.009948266,
    -0.02989663,
    0.06895438,
    0.022714997,
    -0.0043814727,
    0.053324513,
    0.06954041,
    -0.029658752,
    -0.00064212875,
    -0.05751014,
    -0.041275807,
    0.01997424,
    0.07164542,
    -0.07096579,
    0.059776675,
    -0.008295956,
    -0.0018431961,
    -0.07900779,
    0.017407147,
    -0.085871726,
    -0.052633274,
    -0.07232455,
    0.0929916,
    0.021904662,
    0.022412227,
    0.036942277,
    -0.0068861134,
    0.065168664,
    -0.05338148,
    0.011923094,
    0.03735785,
    -0.009789992,
    -0.0028697515,
    0.0786453,
    0.0713528,
    0.018669121,
    0.008281177,
    -0.0013981173,
    0.04601238,
    -0.002409955,
    -0.082886465,
    0.045171123,
    -0.040942702,
    0.002753172,
    -0.003355754,
    -0.024342805,
    -0.03197204,
    -0.035488207,
    -4.840226e-33,
    0.0049598585,
    0.010976215,
    -0.029874483,
    -0.059215307,
    0.03442226,
    -0.040226012,
    0.006731762,
    -0.042254765,
    0.07301959,
    -0.06606888,
    0.070569694,
    0.052416068,
    -0.011748082,
    0.064790435,
    -0.0053734835,
    0.027783887,
    -0.063593455,
    -0.0056604445,
    -0.10281957,
    -0.030554514,
    0.040230323,
    0.028503941,
    0.029551992,
    0.0039154943,
    0.10172384,
    -0.0109644495,
    0.079726286,
    0.12559219,
    0.061549038,
    -0.059233826,
    0.05414421,
    0.036654837,
    -0.03950729,
    -0.043007728,
    0.017449625,
    0.009941346,
    -0.044471048,
    0.0057806903,
    -0.07638498,
    0.004752778,
    0.075254604,
    0.07512973,
    0.007763456,
    -0.0065558245,
    0.054273102,
    -0.04628806,
    -0.02290521,
    -0.05293434,
    -0.01087816,
    -0.09830357,
    -0.036069144,
    -0.02565248,
    0.012334092,
    0.015248946,
    0.058898866,
    -0.009292638,
    0.014171145,
    -0.00924609,
    -0.034088645,
    -0.00093454757,
    -0.012300137,
    -0.0059891096,
    0.053978097,
    0.01866946,
    0.051277164,
    0.005041166,
    0.14417337,
    0.009267839,
    0.029762547,
    0.101817615,
    -0.005693297,
    -0.05521608,
    0.050643273,
    0.03381691,
    -0.011596773,
    0.0015316946,
    -0.025877323,
    -0.053535726,
    -0.035223167,
    -0.049778122,
    0.018605405,
    -0.077602156,
    -0.019236343,
    -0.033479933,
    0.018010715,
    -0.0071565052,
    -0.03674786,
    -0.010350704,
    -0.0006864466,
    0.106212296,
    -0.02333423,
    0.017327437,
    0.02468153,
    0.014905707,
    0.07924083,
    -5.374451e-8,
    0.12361496,
    0.01480315,
    -0.026421776,
    0.039343655,
    -0.07177865,
    -0.016600288,
    0.0004322716,
    -0.077927575,
    -0.06226638,
    -0.0010702352,
    -0.014743383,
    0.10760671,
    -0.012081367,
    -0.0062355064,
    -0.076320976,
    -0.007849354,
    -0.058338556,
    0.001744344,
    0.0250593,
    -0.0010895047,
    -0.059166856,
    -0.016539235,
    -0.023207776,
    -0.048182726,
    0.018252682,
    -0.05187293,
    0.056534525,
    0.034460656,
    -0.004771581,
    0.0030087042,
    -0.017335156,
    0.04792848,
    0.12064261,
    0.084580734,
    0.028384775,
    -0.016843835,
    0.01924476,
    0.1115801,
    0.012086855,
    0.04528298,
    -0.0066653444,
    0.015749194,
    0.050760634,
    -0.008972359,
    -0.0100885425,
    -0.0028225044,
    0.016550386,
    -0.0030054857,
    0.026613977,
    0.006399938,
    -0.023750277,
    0.0022194819,
    -0.08306079,
    -0.032322276,
    -0.040813286,
    -0.02851103,
    -0.12447359,
    -0.0011178314,
    0.04257469,
    -0.06886043,
    -0.09157831,
    -0.052978996,
    -0.005568704,
    -0.01772661,
];

fn main() {
    // Run registered benchmarks.
    divan::main();
}

#[divan::bench]
fn f32_embedding_to_bsp_original_bench() {
    let bits = f32_embedding_to_bsp::<2>(black_box(Array1::from), 200);
    panic!("{bits:?}")
}
